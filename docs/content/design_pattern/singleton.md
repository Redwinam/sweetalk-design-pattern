# 单例模式

## 1 概念

&emsp;&emsp;单例模式（Singleton）是保证一个类仅有一个实例，并提供一个访问它的全局访问点。通常我们可以让一个全局变量使得一个对象被访问，但它不能防止你实例化多个对象。一个最好的办法就是，让类自身负责保存它的唯一实例。这个类可以保证没有其他实例可以被创建，并且它可以提供一个访问该实例的方法。

## 2 知识点

### 2.1 创建唯一实例

- 单例模式包括一个 Singleton 类，主要是定义创建实例的方法，允许访问它的唯一实例，该方法是一个静态方法，主要负责创建自己的唯一实例。
- 单例模式因为 Singleton 类封装它的唯一实例，可以严格控制客户怎样访问它以及何时访问它。简单地说，就是对唯一实例的受控访问。

### 2.2 多线程时的单例模式

- 使用锁控制线程的访问：`lock`确保当一个线程位于代码的临界区时，另一个线程不进入临界区。如果其他线程试图进入锁定的代码，则它将一直等待（即被阻止），直到该对象被释放。

### 2.3 双重锁定

- 先判断实例是否存在，不存在再加锁处理，避免线程每次都加锁，也能保证多线程的安全，该做法被称为`Double-Check Locking`

### 2.4 静态初始化

- 使用静态初始化方法，不需要开发人员显式地编写线程安全代码，即可解决多线程环境下不安全的问题。（书中介绍的是C#与公共语言运行库的做法，其他语言也有相同的方法）
- 饿汉式单例类：静态初始化方法在自己被加载时，将自己实例化
- 懒汉式单例类：在第一次被引用时，才会将自己实例化