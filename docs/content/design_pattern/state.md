# 状态模式

状态模式允许一个对象在内部状态改变时改变它的行为，这个对象看起来好像改变了类。

**设计动机**

当控制一个对象状态转换的条件表达式过于复杂时，把状态的判断逻辑转移到表示不同状态的一系列类中，可以简化复杂的判断逻辑。如果状态的判断很简单，就不需要使用状态模式了。

状态模式将不同状态的行为分割开，将与特定状态相关的行为局部化（放入一个对象），通过新的类很容易新增状态。

状态模式通过把各种状态的转移逻辑分不到 State 的子类之间，减少相互依赖，消除庞大的条件分支判断。

**使用场景**

- 当一个对象的行为取决于它的状态，并且必须在运行时根据状态改变其行为时。
- 某业务有多个状态，且状态变化依赖大量分支判断时。

实际中的例子：多个状态与行为变化。

- 有限状态机。
- TCP 连接协议。
- 其他涉及一系列状态变化的应用。

**不足之处**

- 可能会创建太多功能较为单一的类。
- 新的行为可能涉及大量改动。
- 状态少或很少改变时有点小题大做，此时不应使用状态模式。

**实现方式**

- 将状态的转换放到具体的状态类内部。
- 通过上下文直接或通过参数改变状态，而不同的状态对应不同的行为。

![](img/state.jpeg)